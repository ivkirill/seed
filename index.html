<!DOCTYPE>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
    <title>Berry Index</title>
    
    <script type="text/javascript" charset="UTF-8" src="berry.js"></script>
  </head>
  <body>
    <script>
		define('module1', ['module2', 'module3'], function() {
			console.log('TEST A', this);
			return 'module1';
		});			
		
		define('module2', ['module4'], {path: '/js/berry/berry.test.js'}, function() {
			console.log('TEST B', this);
			return 'module2';
		});
		
		define('module3', ['module4'], {path: '/js/berry/berry.test.js'}, function() {
			console.log('TEST C', this);
			return 'module3';
		});

		define('module4', {path: '/js/berry/berry.test.js'}, function() {
			console.log('TEST D', this);
			return 'module4';
		});
		
		

		/*		
		// определение модул€ 'jquery.1.12.4' с указанным path в обьекте (изменено следование аргументов дл€ примера работы)
		define('jquery.1.12.4', {path: 'https://code.jquery.com/jquery-1.12.4.min.js'}, function() {
			console.log('jQuery version', $.fn.jquery, this);
			return $;
		});
		
		define('jquery.1.7.1', {path: 'https://code.jquery.com/jquery-1.7.1.min.js'}, function() {
			console.log("module 'jquery.1.7.1' loaded", arguments);
			return $;
		});		

		define('jquery.2.2.4', {path: 'https://code.jquery.com/jquery-2.2.4.min.js'}, function() {
			console.log('jQuery version', $.fn.jquery, this);
			return $;
		});		
		
		// определение модул€ 'Prototype'
		define('Prototype', {path: 'https://ajax.googleapis.com/ajax/libs/prototype/1.7.3.0/prototype.js'}, function() {
			console.log('Prototype version', Prototype);
			return Prototype;
		});				
		
		// определение модул€ 'menu'
		define('menu2', [ true, 'common.cookie'], function() {
			var a = 1;
			return a;
		});			
  	
		// определение модул€ 'oldmenu' с поддержкой обратной совместимости
		$.define('oldmenu', function() {
			console.log("module 'oldmenu' loaded");
			var a = 2;
			return a;
		});

		// определение модул€ 'item' с зависимостью от модул€ 'menu'
		define('item', ['menu'], function() {
			console.log("module 'item' loaded, depence from 'menu'");
		});



		
		//кастомный список плагинов проекта
		var plugins = {
			"test.module" : {
				"path" : "berry.test.js"
			},
			"jquery.1.7.1" : {
				"path" : "https://code.jquery.com/jquery-1.7.1.min.js",
				"callback" : function() {
					return 123;
				}
			},
			"jquery.1.12.4" : {
				"path" : "https://code.jquery.com/jquery-1.12.4.min.js"
			},
			"jquery.2.2.4" : {
				"path" : "https://code.jquery.com/jquery-2.2.4.min.js"
			}
		}
      
		define(plugins, function() {
			console.log('Custom plugins loaded');
		});
	  
		// определение модул€ 'live', с зависмостью от модул€ 'jquery.1.7.1'
		define('live', ['menu', 'sub-menu', 'jquery.1.7.1'], function(scope) {
			console.log('live scope вне функции:', scope);
			console.log('live scope вне функции:',$.fn, $, window.jQuery)			
			
			return (function(m, s, jq) {
				console.log('live callback: ', m, s, jq);
			})(scope['menu'], scope['sub-menu'], scope['jquery.1.7.1']);
		});
		
		// определение модул€ 'jquery.1.7.1' с указанным path в обьекте
		define('jquery.1.7.1', {path: 'https://code.jquery.com/jquery-1.7.1.min.js'}, function(scope) {
			console.log('1.7');
			
		
			return (function($) {
				console.log( $.fn );
				return $;
			})(jQuery)

			var a = 10;
			return a;
		});			

		// определение модул€ 'menu'
		define('sub-menu', function() {
			var b = 4;
			return b;
		});

	*/			


		
    </script>
	<img src="https://plarson.ru/i/logo/html5_70x100.png" width="70" height="100">
	<img src="https://plarson.ru/i/logo/css3_70x100.png" width="70" height="100">
	<img src="https://plarson.ru/i/logo/js5_70x100.png" width="70" height="100">
  </body>
</html>